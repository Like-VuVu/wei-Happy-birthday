<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>ç”Ÿæ—¥å¿«ä¹ Â· é­å‰è‰³</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Nunito:wght@400;700&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --bg1: #0f172a;
      --bg2: #1e293b;
      --accent: #ff6b81;
      --accent2: #ffd166;
      --card: #0b1220cc;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: "Nunito", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }

    body {
      background: radial-gradient(1200px 600px at 10% 10%, rgba(255, 107, 129, 0.06), transparent),
        linear-gradient(120deg, var(--bg1), var(--bg2));
      color: #fff;
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* æ˜Ÿå…‰ */
    .stars {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image:
        radial-gradient(rgba(255, 255, 255, 0.06) 1px, transparent 1px),
        radial-gradient(rgba(255, 255, 255, 0.04) 1px, transparent 1px);
      background-size: 180px 180px, 90px 90px;
      opacity: 0.6;
      mix-blend-mode: screen;
      animation: drift 30s linear infinite;
    }

    @keyframes drift {
      from {
        transform: translateY(0);
      }

      to {
        transform: translateY(-200px);
      }
    }

    html,
    body {
      overflow: hidden;
      touch-action: none;
      /* é˜»æ­¢æ‹–åŠ¨æ»šåŠ¨ */
      height: 100%;
    }

    /* ä¸­å¤®å¡ç‰‡ */
    .center {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: min(920px, 92vw);
      max-width: 920px;
      padding: clamp(18px, 2.6vw, 34px);
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.02));
      box-shadow: 0 10px 40px rgba(2, 6, 23, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.02);
      display: flex;
      gap: 24px;
      align-items: center;
      backdrop-filter: blur(6px);
    }

    .left {
      flex: 1;
      min-width: 260px;
    }

    .title {
      font-family: "Playfair Display", serif;
      font-size: clamp(28px, 4.6vw, 48px);
      line-height: 1;
      margin: 0 0 8px 0;
      background: linear-gradient(90deg, var(--accent), #ffd2b6);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 6px 30px rgba(255, 107, 129, 0.10);
    }

    .name {
      font-size: clamp(34px, 6.6vw, 64px);
      font-weight: 700;
      margin: 0 0 6px 0;
      color: var(--accent);
      letter-spacing: 2px;
      text-shadow: 0 6px 30px rgba(0, 0, 0, 0.6);
    }

    .subtitle {
      margin: 0;
      color: #e6e9ef;
      opacity: 0.9;
      font-size: 14px;
    }

    .message {
      margin-top: 16px;
      color: #f3f4f6;
      line-height: 1.6;
      font-size: 15px;
      max-width: 60ch;
    }

    .typed {
      margin-top: 12px;
      color: #fff;
      font-weight: 600;
      font-size: 15px;
      min-height: 42px;
      white-space: pre-wrap;
    }

    /* å³ä¾§ç¤¼ç‰© */
    .right {
      width: 300px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    .gift {
      width: 160px;
      height: 160px;
      position: relative;
      perspective: 800px;
    }

    .box {
      width: 120px;
      height: 120px;
      background: linear-gradient(180deg, #f97316, #fb923c);
      border-radius: 8px;
      position: absolute;
      left: 20px;
      top: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      transform-origin: 50% 0%;
      transition: transform 600ms cubic-bezier(.2, .9, .3, 1);
      z-index: 3;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
    }

    .lid {
      width: 144px;
      height: 30px;
      background: linear-gradient(90deg, #fb7185, #ef4444);
      border-radius: 8px;
      position: absolute;
      left: 8px;
      top: 6px;
      transform-origin: 20% 100%;
      transition: transform 600ms cubic-bezier(.2, .9, .3, 1);
      z-index: 5;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);
    }

    .ribbon {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      top: 48px;
      width: 12px;
      height: 60px;
      background: rgba(255, 255, 255, 0.18);
      border-radius: 6px;
      z-index: 4;
    }

    .bow {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      top: 14px;
      width: 64px;
      height: 40px;
      z-index: 6;
      clip-path: polygon(0 50%, 50% 0, 100% 50%, 50% 100%);
      background: linear-gradient(90deg, #fff6, #fff0);
      opacity: 0.95;
      filter: blur(.6px);
    }

    .btn {
      background: linear-gradient(90deg, var(--accent), #ff8aa2);
      color: #111;
      border: none;
      padding: 12px 18px;
      border-radius: 12px;
      font-weight: 700;
      margin-top: 55px;
      cursor: pointer;
      box-shadow: 0 8px 22px rgba(255, 107, 129, 0.12);
      transition: transform .14s ease, box-shadow .14s ease;
    }

    .btn:active {
      transform: translateY(2px);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
    }

    /* æ°”çƒ */
    .balloon {
      position: absolute;
      width: 46px;
      height: 62px;
      border-radius: 60% 60% 55% 55%/70% 70% 30% 30%;
      transform-origin: center bottom;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      animation: rise 18s linear forwards;
    }

    .string {
      position: absolute;
      width: 2px;
      height: 40px;
      background: rgba(255, 255, 255, 0.12);
      left: 50%;
      transform: translateX(-50%);
      bottom: -36px;
      border-radius: 2px;
    }

    @keyframes rise {
      0% {
        transform: translateY(0) rotate(-3deg);
        opacity: 1;
      }

      100% {
        transform: translateY(-120vh) rotate(6deg);
        opacity: 0;
      }
    }

    .sparkle {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: radial-gradient(circle, #fff, #ffd2c2 60%, transparent 70%);
      filter: blur(.6px);
      opacity: .9;
      mix-blend-mode: screen;
    }

    #confetti {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 20;
    }

    @media (max-width:720px) {
      .center {
        flex-direction: column;
        align-items: flex-start;
        padding: 18px;
        gap: 16px;
      }

      .right {
        width: 100%;
        flex-direction: column;
        align-items: center;
      }

      .gift {
        width: 120px;
        height: 120px;
      }

      .left {
        text-align: center;
      }
    }
  </style>
</head>

<body>
  <div class="stars"></div>
  <div id="balloons"></div>

  <div class="center" role="main" aria-labelledby="greeting">
    <div class="left">
      <h2 class="title" id="greeting">ç”Ÿæ—¥å¿«ä¹</h2>
      <h1 class="name">é­å‰è‰³</h1>
      <p class="subtitle">æ„¿ä½ åœ¨äººé—´æƒŠè‰³ï¼Œæ´»æˆè¯—å’Œè¿œæ–¹ âœ¨</p>
      <div class="message" id="message">
        äº²çˆ±çš„é­å‰è‰³ï¼š<br><br>
        ä»Šå¤©æ˜¯ä½ çš„ç”Ÿæ—¥ï¼Œæ„¿æ¯ä¸€ä¸ªæ„¿æœ›éƒ½è¢«æ¸©æŸ”ä»¥å¾…ï¼Œæ¯ä¸€ä¸ªå¹³å‡¡çš„æ—¥å­éƒ½é—ªç€å°ç¡®å¹¸ã€‚è°¢è°¢ä½ å¸¦æ¥çš„æ¸©æš–ä¸ç¬‘å®¹ï¼Œæ„¿æœªæ¥çš„æ—¥å­ç”œè¿‡èœ‚èœœï¼ŒæŸ”è¿‡æ˜¥é£ã€‚
      </div>
      <div class="typed" id="typed"></div>
    </div>

    <div class="right">
      <div class="gift" aria-hidden="false">
        <div class="lid" id="lid"></div>
        <div class="box" id="box">
          <div class="ribbon"></div>
          <div class="bow"></div>
        </div>
      </div>
      <button class="btn" id="openBtn" aria-pressed="false">ç‚¹æˆ‘æš´å¯Œ ğŸ’°</button>
      <div style="font-size:13px;color:#e6e9ef;opacity:0.85;text-align:center;">
        ä¸€ç‚¹ï¼Œè´¢å¯Œé£æ¥ï½
      </div>

    </div>
  </div>

  <audio id="bgm" src="./assets/happy-birthday-to-you-bossa-nova-style-arrangement-21399.mp3" preload="auto"></audio>
  <canvas id="confetti"></canvas>

  <script>
    // é‡‘å¸/äººæ°‘å¸ä¸Šæµ®ç‰¹æ•ˆ
    const balloonColors = ['#FFD700', '#FFE066', '#FFB84C']; // é‡‘è‰²ç³»
    const emojis = ['ğŸ’°', 'ğŸª™', 'ğŸ’µ', 'ğŸ’´', 'ğŸ’¸', 'ğŸ¦'];
    const balloonsEl = document.getElementById('balloons');

    function createBalloon () {
      const b = document.createElement('div');
      b.className = 'balloon';
      const w = 46 + Math.random() * 24;
      b.style.width = w + 'px';
      b.style.height = Math.round(w * 1.2) + 'px';
      b.style.left = Math.random() * 90 + '%';
      b.style.bottom = '-80px';
      b.style.background = balloonColors[Math.floor(Math.random() * balloonColors.length)];
      b.innerHTML = `<div style="font-size:${16 + Math.random() * 10}px;transform:translateY(-4px);">${emojis[Math.floor(Math.random() * emojis.length)]}</div>`;
      const s = document.createElement('div'); s.className = 'string'; b.appendChild(s);
      balloonsEl.appendChild(b);
      setTimeout(() => b.remove(), 18000);
    }

    setInterval(createBalloon, 2000);
    for (let i = 0; i < 6; i++) createBalloon();

    // æ‰“å­—æœºæ•ˆæœ
    const typedEl = document.getElementById('typed');
    const lines = [
      "æ„¿ä½ é’±åŒ…é¼“é¼“ğŸ’°ï¼Œå¡é‡Œå¤šé›¶ğŸ’³ã€‚",
      "å·¥èµ„ç¿»åå€ï¼Œé¡¹ç›®å…¨ä¸­æ ‡ï¼ğŸš€",
      "æš´å¯Œæš´å¯Œæš´å¯Œï¼Œé­å‰è‰³ï¼Œä¸€å¤œæš´å¯Œï¼ğŸ’µâœ¨"
    ];

    let lineIdx = 0;
    function typeLine (i = 0, charIdx = 0) {
      if (lineIdx >= lines.length) return;
      const line = lines[lineIdx];
      typedEl.textContent = line.slice(0, charIdx);
      if (charIdx < line.length) setTimeout(() => typeLine(i, charIdx + 1), 28 + Math.random() * 50);
      else { lineIdx++; setTimeout(() => typeLine(0, 0), 700); }
    }
    setTimeout(() => typeLine(), 1200);

    // ç¤¼ç‰© & confetti
    const lid = document.getElementById('lid');
    const box = document.getElementById('box');
    const btn = document.getElementById('openBtn');
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    const bgm = document.getElementById('bgm');
    let W = canvas.width = innerWidth;
    let H = canvas.height = innerHeight;
    window.addEventListener('resize', () => { W = canvas.width = innerWidth; H = canvas.height = innerHeight; });
    bgm.loop = true;

    let confettiPieces = [];
    function ConfettiPiece (x, y, color) {
      this.x = x; this.y = y;
      this.vx = (Math.random() - 0.5) * 6;
      this.vy = -(6 + Math.random() * 10);
      this.size = 6 + Math.random() * 8;
      this.color = color || balloonColors[Math.floor(Math.random() * balloonColors.length)];
      this.rotation = Math.random() * 360;
      this.d = Math.random() * 6 + 6;
    }
    ConfettiPiece.prototype.update = function (dt) { this.vy += 0.28 * dt; this.x += this.vx * dt; this.y += this.vy * dt; this.rotation += this.vx * 2; };
    ConfettiPiece.prototype.draw = function (ctx) { ctx.save(); ctx.translate(this.x, this.y); ctx.rotate(this.rotation * Math.PI / 180); ctx.fillStyle = this.color; ctx.fillRect(-this.size / 2, -this.size / 2, this.size, this.size * 0.6); ctx.restore(); };
    let running = false;
    function spawnConfetti (x, y, amount = 50) { for (let i = 0; i < amount; i++) { confettiPieces.push(new ConfettiPiece(x + (Math.random() - 0.5) * 80, y + (Math.random() - 0.5) * 20)); } if (!running) runConfetti(); }
    function runConfetti () {
      running = true;
      let last = performance.now();
      function frame (now) {
        const dt = Math.min(1, (now - last) / 16); last = now;
        ctx.clearRect(0, 0, W, H);
        for (let i = confettiPieces.length - 1; i >= 0; i--) { const p = confettiPieces[i]; p.update(dt); p.draw(ctx); if (p.y > H + 60 || p.x < -80 || p.x > W + 80) confettiPieces.splice(i, 1); }
        if (confettiPieces.length > 0) { requestAnimationFrame(frame); } else { running = false; ctx.clearRect(0, 0, W, H); }
      }
      requestAnimationFrame(frame);
    }

    function spawnMoney (x, y, amount = 20) {
      for (let i = 0; i < amount; i++) {
        const money = document.createElement('div');
        money.textContent = Math.random() > 0.5 ? 'ğŸ’´' : 'ğŸ’µ';
        money.style.position = 'fixed';
        money.style.left = (x + (Math.random() - 0.5) * 120) + 'px';
        money.style.top = (y + (Math.random() - 0.5) * 40) + 'px';
        money.style.fontSize = (24 + Math.random() * 22) + 'px';
        money.style.opacity = 1;
        money.style.transition = 'transform 2.8s ease-out, opacity 2.8s ease';
        document.body.appendChild(money);
        requestAnimationFrame(() => {
          money.style.transform = `translateY(${600 + Math.random() * 200}px) rotate(${Math.random() * 720}deg)`;
          money.style.opacity = 0;
        });
        setTimeout(() => money.remove(), 2800);
      }
    }
    // æ‰‹æœºè§¦æ‘¸äº¤äº’
    function triggerInteraction (x, y) {
      bgm.play().catch(() => { console.log("ç”¨æˆ·äº¤äº’åæ‰èƒ½æ’­æ”¾éŸ³ä¹"); });
      spawnConfetti(x, y, 30);
    }

    let opened = false;
    btn.addEventListener('click', () => {
      const bbox = box.getBoundingClientRect();
      if (!opened) {
        opened = true; btn.setAttribute('aria-pressed', 'true');
        lid.style.transform = 'rotateX(65deg) translateY(-4px)';
        box.style.transform = 'translateY(30px) scale(0.98)';
        setTimeout(() => {
          spawnMoney(bbox.left + bbox.width / 2, bbox.top, 40);
          setInterval(() => { spawnMoney(bbox.left + bbox.width / 2, bbox.top, 20) }, 2000);
        }, 600);
      }
      triggerInteraction(bbox.left + bbox.width / 2, bbox.top);
    });

    document.body.addEventListener('touchstart', (e) => {
      const t = e.touches[0]; triggerInteraction(t.clientX, t.clientY);
    });
    document.body.addEventListener('touchmove', (e) => {
      const t = e.touches[0];
      const s = document.createElement('div');
      s.className = 'sparkle';
      s.style.left = (t.clientX + (Math.random() - 0.5) * 20) + 'px';
      s.style.top = (t.clientY + (Math.random() - 0.5) * 20) + 'px';
      s.style.width = s.style.height = (4 + Math.random() * 6) + 'px';
      s.style.background = ['#fff', '#ffd2c2', '#ff6b81', '#ffd166'][Math.floor(Math.random() * 4)];
      document.body.appendChild(s);
      setTimeout(() => s.remove(), 800);
    });

    const title = document.getElementById('greeting');
    title.addEventListener('touchstart', (e) => {
      const t = e.touches[0];
      const heart = document.createElement('div');
      heart.textContent = 'ğŸ’–';
      heart.style.position = 'fixed';
      heart.style.left = t.clientX + 'px';
      heart.style.top = t.clientY + 'px';
      heart.style.fontSize = (24 + Math.random() * 20) + 'px';
      heart.style.pointerEvents = 'none';
      heart.style.opacity = 1;
      document.body.appendChild(heart);
      let y = 0;
      const anim = setInterval(() => {
        y -= 2;
        heart.style.transform = `translateY(${y}px) scale(${1 - y / 200})`;
        heart.style.opacity = 1 + y / 200;
        if (y < -200) { clearInterval(anim); heart.remove(); }
      }, 16);
    });
  </script>
</body>

</html>